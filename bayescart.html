

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bayescart package &mdash; BayesCART Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="bayescart" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            BayesCART
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">bayescart</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">bayescart package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-bayescart.bcart">bayescart.bcart module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.bcart.BCART"><code class="docutils literal notranslate"><span class="pre">BCART</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.bcart.BCARTClassic"><code class="docutils literal notranslate"><span class="pre">BCARTClassic</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.bcart.BCARTClassicSlow"><code class="docutils literal notranslate"><span class="pre">BCARTClassicSlow</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.bcart.BCARTFast"><code class="docutils literal notranslate"><span class="pre">BCARTFast</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-bayescart.eval">bayescart.eval module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.eval.calc_log_tree_prob"><code class="docutils literal notranslate"><span class="pre">calc_log_tree_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.eval.calc_log_tree_prob_and_llik"><code class="docutils literal notranslate"><span class="pre">calc_log_tree_prob_and_llik()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.eval.calc_tree_llik"><code class="docutils literal notranslate"><span class="pre">calc_tree_llik()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.eval.calc_tree_post_prob"><code class="docutils literal notranslate"><span class="pre">calc_tree_post_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.eval.compare_trees"><code class="docutils literal notranslate"><span class="pre">compare_trees()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.eval.produce_tree_table"><code class="docutils literal notranslate"><span class="pre">produce_tree_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.eval.summarize_trees"><code class="docutils literal notranslate"><span class="pre">summarize_trees()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-bayescart.exceptions">bayescart.exceptions module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.exceptions.AbstractMethodError"><code class="docutils literal notranslate"><span class="pre">AbstractMethodError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.exceptions.InvalidTreeError"><code class="docutils literal notranslate"><span class="pre">InvalidTreeError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.exceptions.NotImplementedError"><code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-bayescart.mytyping">bayescart.mytyping module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-bayescart.node">bayescart.node module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.node.Node"><code class="docutils literal notranslate"><span class="pre">Node</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.node.NodeFast"><code class="docutils literal notranslate"><span class="pre">NodeFast</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-bayescart.node_data">bayescart.node_data module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.node_data.NodeData"><code class="docutils literal notranslate"><span class="pre">NodeData</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.node_data.NodeDataClassification"><code class="docutils literal notranslate"><span class="pre">NodeDataClassification</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.node_data.NodeDataClassificationFast"><code class="docutils literal notranslate"><span class="pre">NodeDataClassificationFast</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.node_data.NodeDataFast"><code class="docutils literal notranslate"><span class="pre">NodeDataFast</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.node_data.NodeDataRegression"><code class="docutils literal notranslate"><span class="pre">NodeDataRegression</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.node_data.NodeDataRegressionFast"><code class="docutils literal notranslate"><span class="pre">NodeDataRegressionFast</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-bayescart.parallel_tempering_base">bayescart.parallel_tempering_base module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.parallel_tempering_base.BCARTPT"><code class="docutils literal notranslate"><span class="pre">BCARTPT</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-bayescart.tempering_geom_lik">bayescart.tempering_geom_lik module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.tempering_geom_lik.BCARTGeomLik"><code class="docutils literal notranslate"><span class="pre">BCARTGeomLik</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-bayescart.tempering_geometric">bayescart.tempering_geometric module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.tempering_geometric.BCARTGeom"><code class="docutils literal notranslate"><span class="pre">BCARTGeom</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-bayescart.tempering_pseudo_prior">bayescart.tempering_pseudo_prior module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.tempering_pseudo_prior.BCARTPseudoPrior"><code class="docutils literal notranslate"><span class="pre">BCARTPseudoPrior</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-bayescart.tree">bayescart.tree module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.tree.Tree"><code class="docutils literal notranslate"><span class="pre">Tree</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.tree.TreeFast"><code class="docutils literal notranslate"><span class="pre">TreeFast</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-bayescart.utils">bayescart.utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.utils.dirichlet_logpdf"><code class="docutils literal notranslate"><span class="pre">dirichlet_logpdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.utils.invgamma_logpdf"><code class="docutils literal notranslate"><span class="pre">invgamma_logpdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.utils.invgamma_rvs"><code class="docutils literal notranslate"><span class="pre">invgamma_rvs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.utils.my_choice"><code class="docutils literal notranslate"><span class="pre">my_choice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.utils.norm_logpdf"><code class="docutils literal notranslate"><span class="pre">norm_logpdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.utils.plot_chain_comm"><code class="docutils literal notranslate"><span class="pre">plot_chain_comm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.utils.plot_hists"><code class="docutils literal notranslate"><span class="pre">plot_hists()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.utils.plot_swap_prob"><code class="docutils literal notranslate"><span class="pre">plot_swap_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#bayescart.utils.sim_cgm98"><code class="docutils literal notranslate"><span class="pre">sim_cgm98()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-bayescart">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BayesCART</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">bayescart</a></li>
      <li class="breadcrumb-item active">bayescart package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/bayescart.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bayescart-package">
<h1>bayescart package<a class="headerlink" href="#bayescart-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-bayescart.bcart">
<span id="bayescart-bcart-module"></span><h2>bayescart.bcart module<a class="headerlink" href="#module-bayescart.bcart" title="Link to this heading"></a></h2>
<p>Bayesian CART (BCART) models.</p>
<p>This module implements the BCART class and several subclasses to perform
Bayesian inference on classification and regression trees.
Subclasses address performance improvements, it is recommended to use these.</p>
<dl class="py class">
<dt class="sig sig-object py" id="bayescart.bcart.BCART">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.bcart.</span></span><span class="sig-name descname"><span class="pre">BCART</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_dirichlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_tree_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stored_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for Bayesian CART (Classification and Regression Trees).</p>
<p>This class provides methods for initializing the tree, running the Markov chain Monte Carlo (MCMC)
sampling, computing likelihoods and priors, resampling parameters, and updating tree moves (grow, prune, change, swap).</p>
<p>Specific MCMC-methods are abstract and should be implemented in derived classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>pd.DataFrame</em>) – Feature data.</p></li>
<li><p><strong>y</strong> (<em>pd.Series</em>) – Response data.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Hyperparameter for the tree prior (default 0.95).</p></li>
<li><p><strong>beta</strong> (<em>float</em><em>, </em><em>optional</em>) – Hyperparameter controlling the split probability decay (default 0.5).</p></li>
<li><p><strong>mu_0</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Initial value for the regression mean (default None, will be sampled).</p></li>
<li><p><strong>sigma_0</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Initial value for the regression standard deviation (default None, will be sampled).</p></li>
<li><p><strong>nu</strong> (<em>float</em><em>, </em><em>optional</em>) – Hyperparameter for the inverse gamma prior (default 3).</p></li>
<li><p><strong>lambd</strong> (<em>float</em><em>, </em><em>optional</em>) – Scale hyperparameter for the inverse gamma prior (default 0.1).</p></li>
<li><p><strong>mu_bar</strong> (<em>float</em><em>, </em><em>optional</em>) – Prior mean for regression (default 0).</p></li>
<li><p><strong>a</strong> (<em>float</em><em>, </em><em>optional</em>) – Hyperparameter (default 0.3).</p></li>
<li><p><strong>node_min_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum observations per node (default 5).</p></li>
<li><p><strong>alpha_dirichlet</strong> (<em>NDArrayLike</em><em>, </em><em>optional</em>) – Parameter(s) for the Dirichlet prior in classification (default 1.0).</p></li>
<li><p><strong>iters</strong> (<em>int</em><em>, </em><em>optional</em>) – Total number of MCMC iterations (default 1250).</p></li>
<li><p><strong>burnin</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of burn-in iterations (default 250).</p></li>
<li><p><strong>thinning</strong> (<em>int</em><em>, </em><em>optional</em>) – Thinning factor (default 1).</p></li>
<li><p><strong>store_tree_spacing</strong> (<em>int</em><em>, </em><em>optional</em>) – Spacing for storing tree copies (default 10).</p></li>
<li><p><strong>max_stored_trees</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of stored trees (default 2000). Caps the total memory consumption.</p></li>
<li><p><strong>move_prob</strong> (<em>Sequence</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Probabilities for the moves (grow, prune, change, swap) (default [0.25,0.25,0.25,0.25]).</p></li>
<li><p><strong>verbose</strong> (<em>str</em><em>, </em><em>optional</em>) – Verbosity level.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em> or </em><em>np.random.Generator</em><em>, </em><em>optional</em>) – Random seed or generator (default 45).</p></li>
<li><p><strong>debug</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, enables debugging assertions (default False).</p></li>
<li><p><strong>light</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, uses lighter copies for speed (default True).</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.is_classification">
<span class="sig-name descname"><span class="pre">is_classification</span></span><a class="headerlink" href="#bayescart.bcart.BCART.is_classification" title="Link to this definition"></a></dt>
<dd><p>True if running a classification task.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.K">
<span class="sig-name descname"><span class="pre">K</span></span><a class="headerlink" href="#bayescart.bcart.BCART.K" title="Link to this definition"></a></dt>
<dd><p>Number of classes (if classification).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Initialize the BCART object with model and MCMC parameters.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_dirichlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_tree_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stored_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize the BCART object with model and MCMC parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.calc_change_swap_mh_data">
<span class="sig-name descname"><span class="pre">calc_change_swap_mh_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.calc_change_swap_mh_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.calc_change_swap_mh_data" title="Link to this definition"></a></dt>
<dd><p>Compute and store move-specific information needed for the change/swap move acceptance ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transition_p</strong> (<em>float</em>) – The transition probability ratio for the move.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.calc_grow_prune_mh_data">
<span class="sig-name descname"><span class="pre">calc_grow_prune_mh_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_to_split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tot_parents_with_two_leaves</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.calc_grow_prune_mh_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.calc_grow_prune_mh_data" title="Link to this definition"></a></dt>
<dd><p>Compute and store move-specific information needed for the grow/prune move acceptance ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – The proposed new tree.</p></li>
<li><p><strong>node_to_split</strong> (<a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><em>Node</em></a>) – The node that was split (or pruned).</p></li>
<li><p><strong>tot_parents_with_two_leaves</strong> (<em>int</em>) – Total number of internal nodes with two leaves.</p></li>
<li><p><strong>b</strong> (<em>int</em>) – The number of leaves in the current tree.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.calc_llik">
<span class="sig-name descname"><span class="pre">calc_llik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.calc_llik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.calc_llik" title="Link to this definition"></a></dt>
<dd><p>Compute the integrated log-likelihood P(Y|X,T) for the tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The integrated log-likelihood.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.calc_log_tree_prob">
<span class="sig-name descname"><span class="pre">calc_log_tree_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.calc_log_tree_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.calc_log_tree_prob" title="Link to this definition"></a></dt>
<dd><p>Compute the log prior probability of the tree structure P(T|X).</p>
<p>This is the prob of sampling a specific tree given a dataset x</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The log prior probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.change_copy">
<span class="sig-name descname"><span class="pre">change_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.change_copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.change_copy" title="Link to this definition"></a></dt>
<dd><p>Pick an internal node and change its splitting rule. Return a copied tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The new tree after the change move.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree">Tree</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.copy" title="Link to this definition"></a></dt>
<dd><p>Create a copy of the BCART object.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A copy of the current BCART instance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Self</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bayescart.exceptions.NotImplementedError" title="bayescart.exceptions.NotImplementedError"><strong>NotImplementedError</strong></a> – To be implemented.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.deep_copy">
<span class="sig-name descname"><span class="pre">deep_copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.deep_copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.deep_copy" title="Link to this definition"></a></dt>
<dd><p>Create a deep copy of the BCART object.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A deep copy.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Self</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bayescart.exceptions.NotImplementedError" title="bayescart.exceptions.NotImplementedError"><strong>NotImplementedError</strong></a> – To be implemented.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.get_acceptance_prob">
<span class="sig-name descname"><span class="pre">get_acceptance_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.get_acceptance_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.get_acceptance_prob" title="Link to this definition"></a></dt>
<dd><p>Compute the acceptance probability for a proposed tree move.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – The proposed tree after a move.</p></li>
<li><p><strong>move</strong> (<em>str</em>) – The move type.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The acceptance probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.get_leaves_counts">
<span class="sig-name descname"><span class="pre">get_leaves_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.get_leaves_counts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.get_leaves_counts" title="Link to this definition"></a></dt>
<dd><p>For classification, compute the counts of observations per class in each leaf.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of shape (n_leaves, n_classes).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>NDArrayInt</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.get_leaves_means">
<span class="sig-name descname"><span class="pre">get_leaves_means</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.get_leaves_means"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.get_leaves_means" title="Link to this definition"></a></dt>
<dd><p>For regression, compute for each leaf the number of observations, the mean, and un-normalized variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(n_obs per leaf, means per leaf, un-normalized variances per leaf)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.get_log_posterior_prob">
<span class="sig-name descname"><span class="pre">get_log_posterior_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.get_log_posterior_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.get_log_posterior_prob" title="Link to this definition"></a></dt>
<dd><p>Compute the log posterior probability of a tree (up to a normalizing constant).</p>
<p>This includes the full conditionals for leaf parameters, the tree prior, and the integrated likelihood.</p>
<p>P(      heta, T | X, Y) prop P(        heta | T, X, Y) * P(T | X, Y)
P(      heta | T, X, Y) = P(mu | T, X, Y, sigma) * P(sigma | T, X, Y)
P(T | X, Y) prop P(Y | T, X) * P(T | X)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The log posterior probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.get_p_split">
<span class="sig-name descname"><span class="pre">get_p_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">depth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.get_p_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.get_p_split" title="Link to this definition"></a></dt>
<dd><p>Compute the probability of splitting a node at a given depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>depth</strong> (<em>int</em>) – The node depth.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The splitting probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.get_posterior_params_mu">
<span class="sig-name descname"><span class="pre">get_posterior_params_mu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">leaf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.get_posterior_params_mu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.get_posterior_params_mu" title="Link to this definition"></a></dt>
<dd><p>Get the posterior parameters for mu for a leaf (regression).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>leaf</strong> (<a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><em>Node</em></a>) – The leaf node.</p></li>
<li><p><strong>new_sigma</strong> (<em>float</em>) – The resampled sigma value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(m, std) for the normal full conditional.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.get_posterior_params_p">
<span class="sig-name descname"><span class="pre">get_posterior_params_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">leaf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.get_posterior_params_p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.get_posterior_params_p" title="Link to this definition"></a></dt>
<dd><p>Get the posterior Dirichlet parameters for a leaf (classification).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>leaf</strong> (<a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><em>Node</em></a>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated Dirichlet parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>NDArrayFloat</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.get_posterior_params_sigma">
<span class="sig-name descname"><span class="pre">get_posterior_params_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">leaf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.get_posterior_params_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.get_posterior_params_sigma" title="Link to this definition"></a></dt>
<dd><p>Get the posterior parameters for sigma for a leaf (regression).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>leaf</strong> (<a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><em>Node</em></a>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(a, scale) parameters for the inverse gamma full conditional.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.grow_copy">
<span class="sig-name descname"><span class="pre">grow_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.grow_copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.grow_copy" title="Link to this definition"></a></dt>
<dd><p>Pick a leaf which has &gt; node_min_size observations. Split it using the splitting rule. Return a copied tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The new tree after the grow move.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree">Tree</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.prune_copy">
<span class="sig-name descname"><span class="pre">prune_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.prune_copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.prune_copy" title="Link to this definition"></a></dt>
<dd><p>Pick a node with two leaves as children and prune them. Return a copied tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The new tree after the prune move.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree">Tree</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.resample_leaf_params">
<span class="sig-name descname"><span class="pre">resample_leaf_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.resample_leaf_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.resample_leaf_params" title="Link to this definition"></a></dt>
<dd><p>Resample the leaf parameters from their full conditionals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.resample_mu_sigma">
<span class="sig-name descname"><span class="pre">resample_mu_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.resample_mu_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.resample_mu_sigma" title="Link to this definition"></a></dt>
<dd><p>Resample mu and sigma for each leaf (regression).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.resample_mu_sigma_old">
<span class="sig-name descname"><span class="pre">resample_mu_sigma_old</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.resample_mu_sigma_old"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.resample_mu_sigma_old" title="Link to this definition"></a></dt>
<dd><p>(Deprecated) Resample mu and sigma using the old full conditional formulas.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – Always raises an exception indicating deprecation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.resample_p">
<span class="sig-name descname"><span class="pre">resample_p</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.resample_p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.resample_p" title="Link to this definition"></a></dt>
<dd><p>Resample class probabilities for each leaf.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.run" title="Link to this definition"></a></dt>
<dd><p>Run the MCMC algorithm for Bayesian CART.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary containing stored trees, integrated likelihoods, terminal region counts,
cache counters, setup parameters, and data information.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.sample_leaf_params">
<span class="sig-name descname"><span class="pre">sample_leaf_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.sample_leaf_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.sample_leaf_params" title="Link to this definition"></a></dt>
<dd><p>Sample new parameters for the leaves from the prior full conditionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(left_leaf_params, right_leaf_params)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.sample_prior_mu">
<span class="sig-name descname"><span class="pre">sample_prior_mu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.sample_prior_mu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.sample_prior_mu" title="Link to this definition"></a></dt>
<dd><p>Sample an initial mu value from the normal prior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sigma</strong> (<em>float</em>) – The sigma value used in the variance of the normal prior.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sampled mu.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.sample_prior_p">
<span class="sig-name descname"><span class="pre">sample_prior_p</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.sample_prior_p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.sample_prior_p" title="Link to this definition"></a></dt>
<dd><p>Sample initial class probabilities from a Dirichlet prior.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The sampled probability vector.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>NDArrayFloat</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.sample_prior_sigma">
<span class="sig-name descname"><span class="pre">sample_prior_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.sample_prior_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.sample_prior_sigma" title="Link to this definition"></a></dt>
<dd><p>Sample an initial sigma value from the inverse gamma prior.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The sampled sigma.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.swap_copy">
<span class="sig-name descname"><span class="pre">swap_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.swap_copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.swap_copy" title="Link to this definition"></a></dt>
<dd><p>Pick a parent-child of internal nodes and swap their splitting rules. If the otehr child has the same rule, then swap parent with both children. Return a copied tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The new tree after the swap move.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree">Tree</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.trans_prob_log">
<span class="sig-name descname"><span class="pre">trans_prob_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.trans_prob_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.trans_prob_log" title="Link to this definition"></a></dt>
<dd><p>(Abstract in this base class) Compute the log transition probability for a move.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>move</strong> (<em>str</em>) – Move type.</p></li>
<li><p><strong>new_tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – Proposed tree.</p></li>
<li><p><strong>old_tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – Current tree.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The log transition probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.exceptions.AbstractMethodError" title="bayescart.exceptions.AbstractMethodError"><strong>AbstractMethodError</strong></a> – Always raised; to be implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCART.update_tree">
<span class="sig-name descname"><span class="pre">update_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">move</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCART.update_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCART.update_tree" title="Link to this definition"></a></dt>
<dd><p>Evolve the tree based on the specified move.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>move</strong> (<em>str</em>) – The move type (‘grow’, ‘prune’, ‘change’, ‘swap’).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The new tree after applying the move.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree">Tree</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bayescart.bcart.BCARTClassic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.bcart.</span></span><span class="sig-name descname"><span class="pre">BCARTClassic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_dirichlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_tree_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stored_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCARTClassic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCARTClassic" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bayescart.bcart.BCARTFast" title="bayescart.bcart.BCARTFast"><code class="xref py py-class docutils literal notranslate"><span class="pre">BCARTFast</span></code></a>, <a class="reference internal" href="#bayescart.bcart.BCARTClassicSlow" title="bayescart.bcart.BCARTClassicSlow"><code class="xref py py-class docutils literal notranslate"><span class="pre">BCARTClassicSlow</span></code></a></p>
<p>BCART implementation using the classic CGM98 algorithm.</p>
<p>Initialize the BCART object with model and MCMC parameters.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bayescart.bcart.BCARTClassicSlow">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.bcart.</span></span><span class="sig-name descname"><span class="pre">BCARTClassicSlow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_dirichlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_tree_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stored_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCARTClassicSlow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCARTClassicSlow" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bayescart.bcart.BCART" title="bayescart.bcart.BCART"><code class="xref py py-class docutils literal notranslate"><span class="pre">BCART</span></code></a></p>
<p>A slower implementation of BCART following the original CGM98 algorithm.</p>
<p>This can be made more efficient by improving underlying operations in the BCART class.</p>
<p>Initialize the BCART object with model and MCMC parameters.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCARTClassicSlow.calc_change_swap_mh_data">
<span class="sig-name descname"><span class="pre">calc_change_swap_mh_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCARTClassicSlow.calc_change_swap_mh_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCARTClassicSlow.calc_change_swap_mh_data" title="Link to this definition"></a></dt>
<dd><p>Compute and store move-specific information needed for the change/swap move acceptance ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transition_p</strong> (<em>float</em>) – The transition probability ratio for the move.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCARTClassicSlow.calc_grow_prune_mh_data">
<span class="sig-name descname"><span class="pre">calc_grow_prune_mh_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_to_split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tot_parents_with_two_leaves</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCARTClassicSlow.calc_grow_prune_mh_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCARTClassicSlow.calc_grow_prune_mh_data" title="Link to this definition"></a></dt>
<dd><p>Compute and store move-specific information needed for the grow/prune move acceptance ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – The proposed new tree.</p></li>
<li><p><strong>node_to_split</strong> (<a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><em>Node</em></a>) – The node that was split (or pruned).</p></li>
<li><p><strong>tot_parents_with_two_leaves</strong> (<em>int</em>) – Total number of internal nodes with two leaves.</p></li>
<li><p><strong>b</strong> (<em>int</em>) – The number of leaves in the current tree.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCARTClassicSlow.trans_prob_log">
<span class="sig-name descname"><span class="pre">trans_prob_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCARTClassicSlow.trans_prob_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCARTClassicSlow.trans_prob_log" title="Link to this definition"></a></dt>
<dd><p>(Abstract in this base class) Compute the log transition probability for a move.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>move</strong> (<em>str</em>) – Move type.</p></li>
<li><p><strong>new_tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – Proposed tree.</p></li>
<li><p><strong>old_tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – Current tree.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The log transition probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.exceptions.AbstractMethodError" title="bayescart.exceptions.AbstractMethodError"><strong>AbstractMethodError</strong></a> – Always raised; to be implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bayescart.bcart.BCARTFast">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.bcart.</span></span><span class="sig-name descname"><span class="pre">BCARTFast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_dirichlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_tree_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stored_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCARTFast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCARTFast" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bayescart.bcart.BCART" title="bayescart.bcart.BCART"><code class="xref py py-class docutils literal notranslate"><span class="pre">BCART</span></code></a></p>
<p>Optimized version of BCART that uses the “fast” classes.</p>
<p>Optimizations:
- Improved memory usage on copy operations (“fast” classes)
- Using custom sampling functions instead of scipy’s for speed
Optimized for memory.</p>
<p>Initialize the BCART object with model and MCMC parameters.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCARTFast.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_dirichlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_tree_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stored_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCARTFast.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCARTFast.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize the BCART object with model and MCMC parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCARTFast.get_log_posterior_prob">
<span class="sig-name descname"><span class="pre">get_log_posterior_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCARTFast.get_log_posterior_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCARTFast.get_log_posterior_prob" title="Link to this definition"></a></dt>
<dd><p>Compute posterior probability for a tree (up to norming constant)
P(      heta, T | X, Y) prop P(        heta | T, X, Y) * P(T | X, Y)
P(      heta | T, X, Y) = P(mu | T, X, Y, sigma) * P(sigma | T, X, Y)
P(T | X, Y) prop P(Y | T, X) * P(T | X)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCARTFast.resample_mu_sigma">
<span class="sig-name descname"><span class="pre">resample_mu_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCARTFast.resample_mu_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCARTFast.resample_mu_sigma" title="Link to this definition"></a></dt>
<dd><p>Resample mu and sigma for each leaf (regression).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCARTFast.sample_prior_sigma">
<span class="sig-name descname"><span class="pre">sample_prior_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCARTFast.sample_prior_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCARTFast.sample_prior_sigma" title="Link to this definition"></a></dt>
<dd><p>Sample an initial sigma value from the inverse gamma prior.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The sampled sigma.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.bcart.BCARTFast.update_tree">
<span class="sig-name descname"><span class="pre">update_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">move</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/bcart.html#BCARTFast.update_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.bcart.BCARTFast.update_tree" title="Link to this definition"></a></dt>
<dd><p>Evolve the tree based on the specified move.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>move</strong> (<em>str</em>) – The move type (‘grow’, ‘prune’, ‘change’, ‘swap’).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The new tree after applying the move.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree">Tree</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-bayescart.eval">
<span id="bayescart-eval-module"></span><h2>bayescart.eval module<a class="headerlink" href="#module-bayescart.eval" title="Link to this heading"></a></h2>
<p>Utility functions for BCART experiments evaluation and analysis.</p>
<p>This module contains helper functions for computing tree probabilities,
comparing trees from BCART runs and provide summary tables of estimated
posterior probabilities for the most commonly visited trees. This can be
used to gauge convergence.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bayescart.eval.calc_log_tree_prob">
<span class="sig-prename descclassname"><span class="pre">bayescart.eval.</span></span><span class="sig-name descname"><span class="pre">calc_log_tree_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/eval.html#calc_log_tree_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.eval.calc_log_tree_prob" title="Link to this definition"></a></dt>
<dd><p>Calculate the log prior probability of a tree given a run result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – The tree for which to compute the prior probability.</p></li>
<li><p><strong>run</strong> (<em>dict</em>) – A run result dictionary containing configuration and data information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The log prior probability P(T|X) of the tree.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bayescart.eval.calc_log_tree_prob_and_llik">
<span class="sig-prename descclassname"><span class="pre">bayescart.eval.</span></span><span class="sig-name descname"><span class="pre">calc_log_tree_prob_and_llik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/eval.html#calc_log_tree_prob_and_llik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.eval.calc_log_tree_prob_and_llik" title="Link to this definition"></a></dt>
<dd><p>Calculate both the log prior probability and the integrated log-likelihood of a tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – The tree for which to compute the probabilities.</p></li>
<li><p><strong>run</strong> (<em>dict</em>) – A run result dictionary containing configuration and data information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple (prior, llik) where ‘prior’ is the log prior probability and ‘llik’
is the integrated log-likelihood of the tree.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bayescart.eval.calc_tree_llik">
<span class="sig-prename descclassname"><span class="pre">bayescart.eval.</span></span><span class="sig-name descname"><span class="pre">calc_tree_llik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/eval.html#calc_tree_llik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.eval.calc_tree_llik" title="Link to this definition"></a></dt>
<dd><p>Calculate the integrated log-likelihood of a tree given a run result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – The tree for which to compute the likelihood.</p></li>
<li><p><strong>run</strong> (<em>dict</em>) – A run result dictionary containing configuration and data information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The integrated log-likelihood P(Y|X,T) of the tree.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bayescart.eval.calc_tree_post_prob">
<span class="sig-prename descclassname"><span class="pre">bayescart.eval.</span></span><span class="sig-name descname"><span class="pre">calc_tree_post_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/eval.html#calc_tree_post_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.eval.calc_tree_post_prob" title="Link to this definition"></a></dt>
<dd><p>Calculate the (log) posterior probability of a tree given a run result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – The tree for which to compute the posterior probability.</p></li>
<li><p><strong>run</strong> (<em>dict</em>) – A run result dictionary containing configuration and data information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The log posterior probability of the given tree.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bayescart.eval.compare_trees">
<span class="sig-prename descclassname"><span class="pre">bayescart.eval.</span></span><span class="sig-name descname"><span class="pre">compare_trees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_or_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prob'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/eval.html#compare_trees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.eval.compare_trees" title="Link to this definition"></a></dt>
<dd><p>Compare two trees to check if they are equivalent under a given mode.</p>
<p>There are different levels of comparison:
- Basic, using buil-in tree comaprison (hard=0)
- Probability, using data likelihood and tree prior (hard=1).
Note that different likelihoods imply different partitions,
with high probability. Instead, the prior should tell apart trees
that have same partition but different structure so that the two
trees are not probabilistically equivalent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree1</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – The first tree to compare.</p></li>
<li><p><strong>tree2</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – The second tree to compare.</p></li>
<li><p><strong>res_or_run</strong> (<em>dict</em><em> or </em><em>list</em>) – Either a single run result dictionary or a list of run results,
used to extract necessary configuration and data.</p></li>
<li><p><strong>type</strong> (<em>str</em><em>, </em><em>optional</em>) – Comparison type (‘basic’ or ‘prob’). Default is ‘prob’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the trees are considered equal under the chosen criteria, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bayescart.eval.produce_tree_table">
<span class="sig-prename descclassname"><span class="pre">bayescart.eval.</span></span><span class="sig-name descname"><span class="pre">produce_tree_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/eval.html#produce_tree_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.eval.produce_tree_table" title="Link to this definition"></a></dt>
<dd><p>Produce a summary table of tree posterior probability estimates across runs.</p>
<dl class="simple">
<dt>This function:</dt><dd><ol class="arabic simple">
<li><p>Extracts the top 5 most frequent trees from each run.</p></li>
<li><p>Pools all top trees and computes a unique set.</p></li>
<li><p>Sorts the unique trees by their average empirical frequency (posterior probability)
across runs.</p></li>
<li><p>Constructs a table with each unique tree’s estimated frequency per run, mean, standard
deviation, and number of terminal nodes.</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>res</strong> (<em>list</em>) – A list of run result dictionaries.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas DataFrame summarizing the frequency estimates for the most frequent trees.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bayescart.eval.summarize_trees">
<span class="sig-prename descclassname"><span class="pre">bayescart.eval.</span></span><span class="sig-name descname"><span class="pre">summarize_trees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prob'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/eval.html#summarize_trees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.eval.summarize_trees" title="Link to this definition"></a></dt>
<dd><p>Summarize the most common trees from a single run.</p>
<p>The function extracts the stored ‘tree_store’ from the run result, summarizes the top
trees using frequency of occurrence (by the chosen comparison type), and optionally plots
each unique tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>run</strong> (<em>dict</em>) – A run result dictionary containing a ‘tree_store’ key.</p></li>
<li><p><strong>top_n</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The number of top trees to extract. If None, all unique trees are returned.</p></li>
<li><p><strong>type</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of comparison to use (‘prob’ or ‘basic’). Default is ‘prob’.</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, each unique tree is displayed using its show() method. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple (freq_list, unique_trees) representing the frequencies and corresponding unique trees.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bayescart.exceptions">
<span id="bayescart-exceptions-module"></span><h2>bayescart.exceptions module<a class="headerlink" href="#module-bayescart.exceptions" title="Link to this heading"></a></h2>
<p>Custom exceptions for bayescart.</p>
<p>This module defines exceptions used by bayescart to signal errors
in tree operations and abstract method implementations.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="bayescart.exceptions.AbstractMethodError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.exceptions.</span></span><span class="sig-name descname"><span class="pre">AbstractMethodError</span></span><a class="reference internal" href="_modules/bayescart/exceptions.html#AbstractMethodError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.exceptions.AbstractMethodError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception raised when an abstract method has not been implemented.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="bayescart.exceptions.InvalidTreeError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.exceptions.</span></span><span class="sig-name descname"><span class="pre">InvalidTreeError</span></span><a class="reference internal" href="_modules/bayescart/exceptions.html#InvalidTreeError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.exceptions.InvalidTreeError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception raised for errors in the tree structure or data.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="bayescart.exceptions.NotImplementedError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.exceptions.</span></span><span class="sig-name descname"><span class="pre">NotImplementedError</span></span><a class="reference internal" href="_modules/bayescart/exceptions.html#NotImplementedError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.exceptions.NotImplementedError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception raised when an abstract method has not been implemented.</p>
</dd></dl>

</section>
<section id="module-bayescart.mytyping">
<span id="bayescart-mytyping-module"></span><h2>bayescart.mytyping module<a class="headerlink" href="#module-bayescart.mytyping" title="Link to this heading"></a></h2>
</section>
<section id="module-bayescart.node">
<span id="bayescart-node-module"></span><h2>bayescart.node module<a class="headerlink" href="#module-bayescart.node" title="Link to this heading"></a></h2>
<p>Node class for bayescart.</p>
<p>This module defines the Node class used to represent nodes in a tree.
It extends the Node implementation from treelib.</p>
<dl class="py class">
<dt class="sig sig-object py" id="bayescart.node.Node">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.node.</span></span><span class="sig-name descname"><span class="pre">Node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></p>
<p>Extended node class for Bayesian CART. Provides functionalities for adding data, splitting, and updating parameters.</p>
<p>This class is mostly a wrapper around the NodeData object, which handles the data and parameters associated with the node.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node.Node.is_l">
<span class="sig-name descname"><span class="pre">is_l</span></span><a class="headerlink" href="#bayescart.node.Node.is_l" title="Link to this definition"></a></dt>
<dd><p>Flag indicating if this node is a left child.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node.Node._data">
<span class="sig-name descname"><span class="pre">_data</span></span><a class="headerlink" href="#bayescart.node.Node._data" title="Link to this definition"></a></dt>
<dd><p>The node data (parameters and associated data).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bayescart.node_data.NodeData" title="bayescart.node_data.NodeData">NodeData</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node.Node._rng">
<span class="sig-name descname"><span class="pre">_rng</span></span><a class="headerlink" href="#bayescart.node.Node._rng" title="Link to this definition"></a></dt>
<dd><p>The random number generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.random.Generator</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node.Node.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><a class="headerlink" href="#bayescart.node.Node.debug" title="Link to this definition"></a></dt>
<dd><p>If True, enable debug checks.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node.Node._depth">
<span class="sig-name descname"><span class="pre">_depth</span></span><a class="headerlink" href="#bayescart.node.Node._depth" title="Link to this definition"></a></dt>
<dd><p>The depth of the node.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Create a new Node object to be placed inside a Tree object</p>
<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.__init__" title="Link to this definition"></a></dt>
<dd><p>Create a new Node object to be placed inside a Tree object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.calc_avail_split_and_vars">
<span class="sig-name descname"><span class="pre">calc_avail_split_and_vars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.calc_avail_split_and_vars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.calc_avail_split_and_vars" title="Link to this definition"></a></dt>
<dd><p>Compute the number of available variables for splitting, and the number of available splits for the current split variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(number of available variables, number of available splits)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.copy" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.count_values">
<span class="sig-name descname"><span class="pre">count_values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.count_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.count_values" title="Link to this definition"></a></dt>
<dd><p>Count the of observations per class.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of counts per class.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>NDArrayInt</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bayescart.node.Node.depth">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">depth</span></span><a class="headerlink" href="#bayescart.node.Node.depth" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.get_available_splits">
<span class="sig-name descname"><span class="pre">get_available_splits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.get_available_splits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.get_available_splits" title="Link to this definition"></a></dt>
<dd><p>Get available splits from the underlying NodeData.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(avail_vars, is_cat)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.get_data_averages">
<span class="sig-name descname"><span class="pre">get_data_averages</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.get_data_averages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.get_data_averages" title="Link to this definition"></a></dt>
<dd><p>Compute data averages (number of observations, mean, un-normalized variance) for regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, mean, un-normalized variance)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.get_data_split">
<span class="sig-name descname"><span class="pre">get_data_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.get_data_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.get_data_split" title="Link to this definition"></a></dt>
<dd><p>Split the node’s data using the current (or provided) split rule.  Returns the left and right data subsets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_var</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The splitting feature. If None, uses the current split_var.</p></li>
<li><p><strong>split_val</strong> (<em>Sequence</em><em>[</em><em>T</em><em>] or </em><em>T</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The splitting value(s). If None, uses the current split_set.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(left_X, right_X, left_y, right_y)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.get_new_split">
<span class="sig-name descname"><span class="pre">get_new_split</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.get_new_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.get_new_split" title="Link to this definition"></a></dt>
<dd><p>Sample a new split for the node.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(split_var, split_val)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.get_nobs">
<span class="sig-name descname"><span class="pre">get_nobs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.get_nobs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.get_nobs" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.get_params" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.get_preds">
<span class="sig-name descname"><span class="pre">get_preds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.get_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.get_preds" title="Link to this definition"></a></dt>
<dd><p>Get the predictions from the node’s model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(indices, predictions)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.get_split_data">
<span class="sig-name descname"><span class="pre">get_split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.get_split_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.get_split_data" title="Link to this definition"></a></dt>
<dd><p>Split the data at this node into two parts. Returns the children.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_var</strong> (<em>str</em>) – The feature to split on.</p></li>
<li><p><strong>split_val</strong> (<em>Sequence</em><em>[</em><em>T</em><em>] or </em><em>T</em>) – The split rule.</p></li>
<li><p><strong>left_params</strong> (<em>Any</em>) – Parameters for the left child.</p></li>
<li><p><strong>right_params</strong> (<em>Any</em>) – Parameters for the right child.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(left_node_data, right_node_data)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.get_split_info">
<span class="sig-name descname"><span class="pre">get_split_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.get_split_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.get_split_info" title="Link to this definition"></a></dt>
<dd><p>Retrieve the current split rule: split variable (str), split value (array if cat, float else), whether the split is categorical.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(split_var, split_val, is_cat)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.get_true_preds">
<span class="sig-name descname"><span class="pre">get_true_preds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.get_true_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.get_true_preds" title="Link to this definition"></a></dt>
<dd><p>Return the true predictions (i.e. the actual response values).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(indices, true response values)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.has_data">
<span class="sig-name descname"><span class="pre">has_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.has_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.has_data" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="bayescart.node.Node.id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#bayescart.node.Node.id" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.is_split_rule_empty">
<span class="sig-name descname"><span class="pre">is_split_rule_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.is_split_rule_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.is_split_rule_empty" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.reset_split_info">
<span class="sig-name descname"><span class="pre">reset_split_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.reset_split_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.reset_split_info" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.update_node_params">
<span class="sig-name descname"><span class="pre">update_node_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.update_node_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.update_node_params" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.update_split_data">
<span class="sig-name descname"><span class="pre">update_split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.update_split_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.update_split_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.Node.update_split_info">
<span class="sig-name descname"><span class="pre">update_split_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#Node.update_split_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.Node.update_split_info" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bayescart.node.NodeFast">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.node.</span></span><span class="sig-name descname"><span class="pre">NodeFast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#NodeFast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.NodeFast" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a></p>
<p>Fast implementation of Node with optimized copy operations.</p>
<p>Create a new Node object to be placed inside a Tree object</p>
<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node.NodeFast.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node.html#NodeFast.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node.NodeFast.copy" title="Link to this definition"></a></dt>
<dd><p>Copy the node, with an option for a light (optimized) copy.</p>
<p>Change: Instead of thoroughly copying the object, just copy what we know we need.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-bayescart.node_data">
<span id="bayescart-node-data-module"></span><h2>bayescart.node_data module<a class="headerlink" href="#module-bayescart.node_data" title="Link to this heading"></a></h2>
<p>Node data classes for bayescart.</p>
<p>This module defines classes that encapsulate the data associated with
a tree node. It provides a base class NodeData along with subclasses for
regression (NodeDataRegression) and classification (NodeDataClassification).</p>
<dl class="py class">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.node_data.</span></span><span class="sig-name descname"><span class="pre">NodeData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_cat_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class for data associated with a node in the CART tree.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.X">
<span class="sig-name descname"><span class="pre">X</span></span><a class="headerlink" href="#bayescart.node_data.NodeData.X" title="Link to this definition"></a></dt>
<dd><p>The data features at this node.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.y">
<span class="sig-name descname"><span class="pre">y</span></span><a class="headerlink" href="#bayescart.node_data.NodeData.y" title="Link to this definition"></a></dt>
<dd><p>The response variable at this node.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.rng">
<span class="sig-name descname"><span class="pre">rng</span></span><a class="headerlink" href="#bayescart.node_data.NodeData.rng" title="Link to this definition"></a></dt>
<dd><p>Random number generator for sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.random.Generator</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><a class="headerlink" href="#bayescart.node_data.NodeData.debug" title="Link to this definition"></a></dt>
<dd><p>If True, enables additional debugging checks.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.node_min_size">
<span class="sig-name descname"><span class="pre">node_min_size</span></span><a class="headerlink" href="#bayescart.node_data.NodeData.node_min_size" title="Link to this definition"></a></dt>
<dd><p>Minimum number of observations required in the node.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.split_var">
<span class="sig-name descname"><span class="pre">split_var</span></span><a class="headerlink" href="#bayescart.node_data.NodeData.split_var" title="Link to this definition"></a></dt>
<dd><p>The variable used for splitting (if any).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.split_set">
<span class="sig-name descname"><span class="pre">split_set</span></span><a class="headerlink" href="#bayescart.node_data.NodeData.split_set" title="Link to this definition"></a></dt>
<dd><p>The value(s) used in the splitting rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Sequence[T] or T</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.is_cat_split">
<span class="sig-name descname"><span class="pre">is_cat_split</span></span><a class="headerlink" href="#bayescart.node_data.NodeData.is_cat_split" title="Link to this definition"></a></dt>
<dd><p>Indicator whether the split is categorical.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.avail_splits">
<span class="sig-name descname"><span class="pre">avail_splits</span></span><a class="headerlink" href="#bayescart.node_data.NodeData.avail_splits" title="Link to this definition"></a></dt>
<dd><p>Cached available splits (initially None).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">X</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_cat_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.calc_avail_split_and_vars">
<span class="sig-name descname"><span class="pre">calc_avail_split_and_vars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.calc_avail_split_and_vars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.calc_avail_split_and_vars" title="Link to this definition"></a></dt>
<dd><p>Compute the number of available variables and the number of available splits for the current split variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple (n_avail_vars, n_splits).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.copy" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#bayescart.node_data.NodeData" title="bayescart.node_data.NodeData"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeData</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.count_values">
<span class="sig-name descname"><span class="pre">count_values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.count_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.count_values" title="Link to this definition"></a></dt>
<dd><p>Compute the number of observations per class (classification only).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of counts for each class.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>NDArrayInt</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bayescart.exceptions.AbstractMethodError" title="bayescart.exceptions.AbstractMethodError"><strong>AbstractMethodError</strong></a> – Always raised; should be implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.get_available_splits">
<span class="sig-name descname"><span class="pre">get_available_splits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assert_cached</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.get_available_splits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.get_available_splits" title="Link to this definition"></a></dt>
<dd><p>For each feature in X, return the available unique splits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>force_eval</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, force re-evaluation of available splits (default is False).</p></li>
<li><p><strong>assert_cached</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, raise an error if a cached value is not available (default is False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>A dictionary mapping feature names to sorted unique available split values.</p></li>
<li><p>A dictionary mapping feature names to booleans indicating if the feature is categorical.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.get_data_averages">
<span class="sig-name descname"><span class="pre">get_data_averages</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.get_data_averages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.get_data_averages" title="Link to this definition"></a></dt>
<dd><p>Compute the number of observations, the mean, and un-normalized variance (regression only).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, mean, un-normalized variance)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bayescart.exceptions.AbstractMethodError" title="bayescart.exceptions.AbstractMethodError"><strong>AbstractMethodError</strong></a> – Always raised; should be implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.get_data_split">
<span class="sig-name descname"><span class="pre">get_data_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.get_data_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.get_data_split" title="Link to this definition"></a></dt>
<dd><p>Split the data into left and right subsets based on the split rule. Returns the left and right data subsets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_var</strong> (<em>str</em>) – The feature on which to split.</p></li>
<li><p><strong>split_val</strong> (<em>Sequence</em><em>[</em><em>T</em><em>] or </em><em>T</em>) – The split value(s).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple (left_X, right_X, left_y, right_y).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.get_nobs">
<span class="sig-name descname"><span class="pre">get_nobs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.get_nobs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.get_nobs" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.get_nobs_from_arg">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_nobs_from_arg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.get_nobs_from_arg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.get_nobs_from_arg" title="Link to this definition"></a></dt>
<dd><p>Get the number of observations from a DataFrame or Series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>pd.DataFrame</em><em> or </em><em>pd.Series</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of rows (observations).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.get_params" title="Link to this definition"></a></dt>
<dd><p>Retrieve the node-specific parameters (e.g., mu and sigma for regression, or p for classification).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>print</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, return a formatted string (default is False).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The node parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.exceptions.AbstractMethodError" title="bayescart.exceptions.AbstractMethodError"><strong>AbstractMethodError</strong></a> – Always raised; should be implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.get_preds">
<span class="sig-name descname"><span class="pre">get_preds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.get_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.get_preds" title="Link to this definition"></a></dt>
<dd><p>Compute the model predictions (e.g., posterior mean).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple (indices, predictions).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bayescart.exceptions.AbstractMethodError" title="bayescart.exceptions.AbstractMethodError"><strong>AbstractMethodError</strong></a> – Always raised; should be implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.get_split_data">
<span class="sig-name descname"><span class="pre">get_split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.get_split_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.get_split_data" title="Link to this definition"></a></dt>
<dd><p>Split the current node’s data into two subsets (left and right) based on a given split rule
and generate new NodeData objects for the children.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_var</strong> (<em>str</em>) – The feature on which to split.</p></li>
<li><p><strong>split_val</strong> (<em>Sequence</em><em>[</em><em>T</em><em>] or </em><em>T</em>) – The split value(s).</p></li>
<li><p><strong>left_params</strong> (<em>Any</em>) – Parameters for the left child.</p></li>
<li><p><strong>right_params</strong> (<em>Any</em>) – Parameters for the right child.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple (l_node_data, r_node_data) corresponding to the left and right NodeData objects.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.exceptions.AbstractMethodError" title="bayescart.exceptions.AbstractMethodError"><strong>AbstractMethodError</strong></a> – Always raised; this method should be implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.get_split_set">
<span class="sig-name descname"><span class="pre">get_split_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.get_split_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.get_split_set" title="Link to this definition"></a></dt>
<dd><p>Get the splitting value(s) for this node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>print</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, return a formatted string description (default is False).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The splitting value(s) or a description thereof.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Sequence[T] or T</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.get_split_var">
<span class="sig-name descname"><span class="pre">get_split_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.get_split_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.get_split_var" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.has_data">
<span class="sig-name descname"><span class="pre">has_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.has_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.has_data" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.is_split_rule_emtpy">
<span class="sig-name descname"><span class="pre">is_split_rule_emtpy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.is_split_rule_emtpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.is_split_rule_emtpy" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.reset_avail_splits">
<span class="sig-name descname"><span class="pre">reset_avail_splits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.reset_avail_splits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.reset_avail_splits" title="Link to this definition"></a></dt>
<dd><p>Reset the cached available splits. Necessary whenever the underlying dataset changes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.reset_split_info">
<span class="sig-name descname"><span class="pre">reset_split_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.reset_split_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.reset_split_info" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.sample_split">
<span class="sig-name descname"><span class="pre">sample_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avail_vals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.sample_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.sample_split" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>)], <code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>)]]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.update_node_params">
<span class="sig-name descname"><span class="pre">update_node_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.update_node_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.update_node_params" title="Link to this definition"></a></dt>
<dd><p>Update the node parameters with new values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>] or </em><em>NDArrayFloat</em>) – The new parameter values.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.exceptions.AbstractMethodError" title="bayescart.exceptions.AbstractMethodError"><strong>AbstractMethodError</strong></a> – Always raised; should be implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.update_split_data">
<span class="sig-name descname"><span class="pre">update_split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.update_split_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.update_split_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeData.update_split_info">
<span class="sig-name descname"><span class="pre">update_split_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeData.update_split_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeData.update_split_info" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Series</span></em><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataClassification">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.node_data.</span></span><span class="sig-name descname"><span class="pre">NodeDataClassification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataClassification"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataClassification" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bayescart.node_data.NodeData" title="bayescart.node_data.NodeData"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeData</span></code></a></p>
<p>Node data class for classification trees.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataClassification.p">
<span class="sig-name descname"><span class="pre">p</span></span><a class="headerlink" href="#bayescart.node_data.NodeDataClassification.p" title="Link to this definition"></a></dt>
<dd><p>The probability vector for the classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>NDArrayFloat</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataClassification.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataClassification.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataClassification.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataClassification.count_values">
<span class="sig-name descname"><span class="pre">count_values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataClassification.count_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataClassification.count_values" title="Link to this definition"></a></dt>
<dd><p>Compute the number of observations per class (classification only).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of counts for each class.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>NDArrayInt</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bayescart.exceptions.AbstractMethodError" title="bayescart.exceptions.AbstractMethodError"><strong>AbstractMethodError</strong></a> – Always raised; should be implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataClassification.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataClassification.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataClassification.get_params" title="Link to this definition"></a></dt>
<dd><p>Retrieve the node-specific parameters (e.g., mu and sigma for regression, or p for classification).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>print</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, return a formatted string (default is False).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The node parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.exceptions.AbstractMethodError" title="bayescart.exceptions.AbstractMethodError"><strong>AbstractMethodError</strong></a> – Always raised; should be implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataClassification.get_split_data">
<span class="sig-name descname"><span class="pre">get_split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataClassification.get_split_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataClassification.get_split_data" title="Link to this definition"></a></dt>
<dd><p>Split the data for classification and generate new NodeDataClassification objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_var</strong> (<em>str</em>) – The feature to split on.</p></li>
<li><p><strong>split_val</strong> (<em>Sequence</em><em>[</em><em>T</em><em>] or </em><em>T</em>) – The splitting rule.</p></li>
<li><p><strong>left_params</strong> (<em>NDArrayFloat</em>) – New class probability vector for the left child.</p></li>
<li><p><strong>right_params</strong> (<em>NDArrayFloat</em>) – New class probability vector for the right child.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(l_node_data, r_node_data)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataClassification.update_node_params">
<span class="sig-name descname"><span class="pre">update_node_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataClassification.update_node_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataClassification.update_node_params" title="Link to this definition"></a></dt>
<dd><p>Update the node parameters with new values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>] or </em><em>NDArrayFloat</em>) – The new parameter values.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.exceptions.AbstractMethodError" title="bayescart.exceptions.AbstractMethodError"><strong>AbstractMethodError</strong></a> – Always raised; should be implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataClassificationFast">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.node_data.</span></span><span class="sig-name descname"><span class="pre">NodeDataClassificationFast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataClassificationFast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataClassificationFast" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bayescart.node_data.NodeDataFast" title="bayescart.node_data.NodeDataFast"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeDataFast</span></code></a>, <a class="reference internal" href="#bayescart.node_data.NodeDataClassification" title="bayescart.node_data.NodeDataClassification"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeDataClassification</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataClassificationFast.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataClassificationFast.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataClassificationFast.copy" title="Link to this definition"></a></dt>
<dd><p>Instead of thoroughly copying the object, just copy what we know we need.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataFast">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.node_data.</span></span><span class="sig-name descname"><span class="pre">NodeDataFast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_cat_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataFast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataFast" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bayescart.node_data.NodeData" title="bayescart.node_data.NodeData"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeData</span></code></a></p>
<p>Efficient implementation of NodeData, reduces the cost of copy operations.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataFast.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataFast.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataFast.copy" title="Link to this definition"></a></dt>
<dd><p>Instead of thoroughly copying the object, just copy what we know we need.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#bayescart.node_data.NodeData" title="bayescart.node_data.NodeData"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeData</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataRegression">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.node_data.</span></span><span class="sig-name descname"><span class="pre">NodeDataRegression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataRegression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataRegression" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bayescart.node_data.NodeData" title="bayescart.node_data.NodeData"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeData</span></code></a></p>
<p>Node data class for regression trees.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataRegression.mu">
<span class="sig-name descname"><span class="pre">mu</span></span><a class="headerlink" href="#bayescart.node_data.NodeDataRegression.mu" title="Link to this definition"></a></dt>
<dd><p>The mean parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataRegression.sigma">
<span class="sig-name descname"><span class="pre">sigma</span></span><a class="headerlink" href="#bayescart.node_data.NodeDataRegression.sigma" title="Link to this definition"></a></dt>
<dd><p>The standard deviation parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataRegression.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataRegression.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataRegression.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataRegression.get_data_averages">
<span class="sig-name descname"><span class="pre">get_data_averages</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataRegression.get_data_averages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataRegression.get_data_averages" title="Link to this definition"></a></dt>
<dd><p>Compute the number of observations, mean, and un-normalized variance for regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, mean, uvar)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataRegression.get_mu">
<span class="sig-name descname"><span class="pre">get_mu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataRegression.get_mu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataRegression.get_mu" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataRegression.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataRegression.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataRegression.get_params" title="Link to this definition"></a></dt>
<dd><p>Retrieve the node-specific parameters (e.g., mu and sigma for regression, or p for classification).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>print</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, return a formatted string (default is False).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The node parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.exceptions.AbstractMethodError" title="bayescart.exceptions.AbstractMethodError"><strong>AbstractMethodError</strong></a> – Always raised; should be implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataRegression.get_preds">
<span class="sig-name descname"><span class="pre">get_preds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataRegression.get_preds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataRegression.get_preds" title="Link to this definition"></a></dt>
<dd><p>Get predictions for regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(indices, predicted constant value equal to mu)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataRegression.get_sigma">
<span class="sig-name descname"><span class="pre">get_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataRegression.get_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataRegression.get_sigma" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataRegression.get_split_data">
<span class="sig-name descname"><span class="pre">get_split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataRegression.get_split_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataRegression.get_split_data" title="Link to this definition"></a></dt>
<dd><p>Split the data for regression and generate new NodeDataRegression objects for the left and right children.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_var</strong> (<em>str</em>) – The feature to split on.</p></li>
<li><p><strong>split_val</strong> (<em>Sequence</em><em>[</em><em>T</em><em>] or </em><em>T</em>) – The splitting threshold (or set).</p></li>
<li><p><strong>left_params</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – Parameters (mu, sigma) for the left child.</p></li>
<li><p><strong>right_params</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – Parameters (mu, sigma) for the right child.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(l_node_data, r_node_data)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataRegression.update_node_params">
<span class="sig-name descname"><span class="pre">update_node_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataRegression.update_node_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataRegression.update_node_params" title="Link to this definition"></a></dt>
<dd><p>Update the node parameters with new values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>] or </em><em>NDArrayFloat</em>) – The new parameter values.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.exceptions.AbstractMethodError" title="bayescart.exceptions.AbstractMethodError"><strong>AbstractMethodError</strong></a> – Always raised; should be implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataRegressionFast">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.node_data.</span></span><span class="sig-name descname"><span class="pre">NodeDataRegressionFast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataRegressionFast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataRegressionFast" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bayescart.node_data.NodeDataFast" title="bayescart.node_data.NodeDataFast"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeDataFast</span></code></a>, <a class="reference internal" href="#bayescart.node_data.NodeDataRegression" title="bayescart.node_data.NodeDataRegression"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeDataRegression</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataRegressionFast.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataRegressionFast.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataRegressionFast.copy" title="Link to this definition"></a></dt>
<dd><p>Instead of thoroughly copying the object, just copy what we know we need.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.node_data.NodeDataRegressionFast.get_data_averages">
<span class="sig-name descname"><span class="pre">get_data_averages</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/node_data.html#NodeDataRegressionFast.get_data_averages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.node_data.NodeDataRegressionFast.get_data_averages" title="Link to this definition"></a></dt>
<dd><p>Compute the number of observations, mean, and un-normalized variance using fast routines.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(n, mean, uvar)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-bayescart.parallel_tempering_base">
<span id="bayescart-parallel-tempering-base-module"></span><h2>bayescart.parallel_tempering_base module<a class="headerlink" href="#module-bayescart.parallel_tempering_base" title="Link to this heading"></a></h2>
<p>Bayesian CART (BCART) models solved using parallel tempering.</p>
<p>This module implements the parallel tempering algorithm for addressing
the multimodality of BCART posterior space. This is an abstract base class.
Subclasses will implement the specific parallel tempering logic, such as
how to apply flattening of the posterior distribution.</p>
<dl class="py class">
<dt class="sig sig-object py" id="bayescart.parallel_tempering_base.BCARTPT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.parallel_tempering_base.</span></span><span class="sig-name descname"><span class="pre">BCARTPT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_dirichlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_tree_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stored_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/parallel_tempering_base.html#BCARTPT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.parallel_tempering_base.BCARTPT" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bayescart.bcart.BCARTClassic" title="bayescart.bcart.BCARTClassic"><code class="xref py py-class docutils literal notranslate"><span class="pre">BCARTClassic</span></code></a></p>
<p>Base class for Parallel Tempering variants of BCART.</p>
<p>Supports staggered activation of chains through steps_per_chain.
This can help warmer chains to converge before adding more chains
closer to the cold one (target chain).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temps</strong> (<em>Sequence</em><em>[</em><em>float</em><em>] or </em><em>NDArrayFloat</em>) – List of temperatures for each chain. One of the ends must be 1.</p></li>
<li><p><strong>steps_per_chain</strong> (<em>Sequence</em><em>[</em><em>int</em><em>] or </em><em>NDArray</em><em>[</em><em>int</em><em>] or </em><em>None</em><em>, </em><em>optional</em>) – Number of iterations to run before unlocking additional chains.</p></li>
<li><p><strong>swap_type</strong> (<em>str</em><em>, </em><em>optional</em>) – Swap type: ‘stochastic’ or deterministic (default ‘stochastic’).</p></li>
</ul>
</dd>
</dl>
<p>Initialize the BCART object with model and MCMC parameters.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bayescart.parallel_tempering_base.BCARTPT.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_dirichlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_tree_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stored_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bayescart.parallel_tempering_base.BCARTPT.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize the BCART object with model and MCMC parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.parallel_tempering_base.BCARTPT.get_acceptance_prob">
<span class="sig-name descname"><span class="pre">get_acceptance_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/parallel_tempering_base.html#BCARTPT.get_acceptance_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.parallel_tempering_base.BCARTPT.get_acceptance_prob" title="Link to this definition"></a></dt>
<dd><p>Compute the acceptance probability for a move in the parallel tempering framework.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – The proposed tree.</p></li>
<li><p><strong>move</strong> (<em>str</em>) – The move type.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The acceptance probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.parallel_tempering_base.BCARTPT.get_swap_acceptance_prob">
<span class="sig-name descname"><span class="pre">get_swap_acceptance_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree_from</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_to</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/parallel_tempering_base.html#BCARTPT.get_swap_acceptance_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.parallel_tempering_base.BCARTPT.get_swap_acceptance_prob" title="Link to this definition"></a></dt>
<dd><p>Compute the swap acceptance probability between two chains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree_from</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – The tree from one chain.</p></li>
<li><p><strong>tree_to</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – The tree from the adjacent chain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The swap acceptance probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.exceptions.NotImplementedError" title="bayescart.exceptions.NotImplementedError"><strong>NotImplementedError</strong></a> – This method must be implemented in subclasses.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.parallel_tempering_base.BCARTPT.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/parallel_tempering_base.html#BCARTPT.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.parallel_tempering_base.BCARTPT.run" title="Link to this definition"></a></dt>
<dd><p>Run the Parallel Tempering MCMC sampler.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary containing MCMC results and tempering statistics.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.parallel_tempering_base.BCARTPT.tempering">
<span class="sig-name descname"><span class="pre">tempering</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#bayescart.parallel_tempering_base.BCARTPT.tempering" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-bayescart.tempering_geom_lik">
<span id="bayescart-tempering-geom-lik-module"></span><h2>bayescart.tempering_geom_lik module<a class="headerlink" href="#module-bayescart.tempering_geom_lik" title="Link to this heading"></a></h2>
<p>Bayesian CART (BCART) models solved using geometric-likelihood parallel tempering.
Only the likelihood is flattened, thereby preserving prior information on the importnance
of different tree sizes. The prior is used instrumentally to guide the search over small trees.</p>
<p>Disentangling the likelihood from the prior leads to sensible analytical simplifications and performacne gains (also in terms of convergence). However, this approach loses the ability
to leverage prior inforamtion, as it is now used to constrain smaller trees in heated chains.</p>
<p>This module implements the geometric-likelihood parallel tempering algorithm for addressing
the multimodality of BCART posterior space.</p>
<dl class="py class">
<dt class="sig sig-object py" id="bayescart.tempering_geom_lik.BCARTGeomLik">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.tempering_geom_lik.</span></span><span class="sig-name descname"><span class="pre">BCARTGeomLik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_dirichlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_tree_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stored_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tempering_geom_lik.html#BCARTGeomLik"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tempering_geom_lik.BCARTGeomLik" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bayescart.parallel_tempering_base.BCARTPT" title="bayescart.parallel_tempering_base.BCARTPT"><code class="xref py py-class docutils literal notranslate"><span class="pre">BCARTPT</span></code></a></p>
<p>Geometric-Likelihood parallel tempering implementation.</p>
<p>In this variant, only the likelihood is flattened, while the prior remains unchanged.</p>
<p>Initialize the BCART object with model and MCMC parameters.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tempering_geom_lik.BCARTGeomLik.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_dirichlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_tree_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stored_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bayescart.tempering_geom_lik.BCARTGeomLik.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize the BCART object with model and MCMC parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tempering_geom_lik.BCARTGeomLik.get_swap_acceptance_prob">
<span class="sig-name descname"><span class="pre">get_swap_acceptance_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree_from</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_to</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tempering_geom_lik.html#BCARTGeomLik.get_swap_acceptance_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tempering_geom_lik.BCARTGeomLik.get_swap_acceptance_prob" title="Link to this definition"></a></dt>
<dd><p>Compute the swap acceptance probability for the geometric-likelihood variant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree_from</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>)</p></li>
<li><p><strong>tree_to</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The swap acceptance probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-bayescart.tempering_geometric">
<span id="bayescart-tempering-geometric-module"></span><h2>bayescart.tempering_geometric module<a class="headerlink" href="#module-bayescart.tempering_geometric" title="Link to this heading"></a></h2>
<p>Bayesian CART (BCART) models solved using geometric parallel tempering,
the whole posterior distribution is flattened uniformly.</p>
<p>This module implements the geometric parallel tempering algorithm for addressing
the multimodality of BCART posterior space.</p>
<dl class="py class">
<dt class="sig sig-object py" id="bayescart.tempering_geometric.BCARTGeom">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.tempering_geometric.</span></span><span class="sig-name descname"><span class="pre">BCARTGeom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_dirichlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_tree_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stored_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tempering_geometric.html#BCARTGeom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tempering_geometric.BCARTGeom" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bayescart.parallel_tempering_base.BCARTPT" title="bayescart.parallel_tempering_base.BCARTPT"><code class="xref py py-class docutils literal notranslate"><span class="pre">BCARTPT</span></code></a></p>
<p>Geometric parallel tempering implementation of Bayesian CART.</p>
<p>In this variant, the posterior of each chain is raised to a power controlled by the temperature. This yields a flattening effect. Chains furthest from the original one (t=1) are designed to explore the space fully. However, this leads to the search over very big trees, which are computationally expensive. It also slows down the convergence of the original chain (beyond runtime, because it is difficult to undo big trees).</p>
<p>Initialize the BCART object with model and MCMC parameters.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tempering_geometric.BCARTGeom.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_dirichlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_tree_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stored_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bayescart.tempering_geometric.BCARTGeom.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize the BCART object with model and MCMC parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tempering_geometric.BCARTGeom.calc_change_swap_mh_data">
<span class="sig-name descname"><span class="pre">calc_change_swap_mh_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tempering_geometric.html#BCARTGeom.calc_change_swap_mh_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tempering_geometric.BCARTGeom.calc_change_swap_mh_data" title="Link to this definition"></a></dt>
<dd><p>Compute and store move-specific information needed for the change/swap move acceptance ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transition_p</strong> (<em>float</em>) – The transition probability ratio for the move.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tempering_geometric.BCARTGeom.calc_grow_prune_mh_data">
<span class="sig-name descname"><span class="pre">calc_grow_prune_mh_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_to_split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tot_parents_with_two_leaves</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tempering_geometric.html#BCARTGeom.calc_grow_prune_mh_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tempering_geometric.BCARTGeom.calc_grow_prune_mh_data" title="Link to this definition"></a></dt>
<dd><p>Compute and store move-specific information needed for the grow/prune move acceptance ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – The proposed new tree.</p></li>
<li><p><strong>node_to_split</strong> (<a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><em>Node</em></a>) – The node that was split (or pruned).</p></li>
<li><p><strong>tot_parents_with_two_leaves</strong> (<em>int</em>) – Total number of internal nodes with two leaves.</p></li>
<li><p><strong>b</strong> (<em>int</em>) – The number of leaves in the current tree.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tempering_geometric.BCARTGeom.get_swap_acceptance_prob">
<span class="sig-name descname"><span class="pre">get_swap_acceptance_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree_from</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_to</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tempering_geometric.html#BCARTGeom.get_swap_acceptance_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tempering_geometric.BCARTGeom.get_swap_acceptance_prob" title="Link to this definition"></a></dt>
<dd><p>Compute the acceptance probability for a swap between chains in the geometric tempering variant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree_from</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>)</p></li>
<li><p><strong>tree_to</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The swap acceptance probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tempering_geometric.BCARTGeom.trans_prob_log">
<span class="sig-name descname"><span class="pre">trans_prob_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tempering_geometric.html#BCARTGeom.trans_prob_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tempering_geometric.BCARTGeom.trans_prob_log" title="Link to this definition"></a></dt>
<dd><p>(Abstract in this base class) Compute the log transition probability for a move.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>move</strong> (<em>str</em>) – Move type.</p></li>
<li><p><strong>new_tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – Proposed tree.</p></li>
<li><p><strong>old_tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – Current tree.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The log transition probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.exceptions.AbstractMethodError" title="bayescart.exceptions.AbstractMethodError"><strong>AbstractMethodError</strong></a> – Always raised; to be implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-bayescart.tempering_pseudo_prior">
<span id="bayescart-tempering-pseudo-prior-module"></span><h2>bayescart.tempering_pseudo_prior module<a class="headerlink" href="#module-bayescart.tempering_pseudo_prior" title="Link to this heading"></a></h2>
<p>Bayesian CART (BCART) models solved using tempering with a pseudo-prior.
Only the likelihood is flattened, thereby preserving prior information on the importnance
of different tree sizes. The prior is left unchanged as it should be used to inform the
model with previous information. Instead, a pseudo-prior is used instrumentally
to guide the search over small trees.</p>
<p>We take as pseudo prior the same CGM98 prior to benefit from substantial cancellations
in computing acceptance rates.</p>
<p>This module implements the tempering with a pseudo-prior algorithm for addressing
the multimodality of BCART posterior space.</p>
<dl class="py class">
<dt class="sig sig-object py" id="bayescart.tempering_pseudo_prior.BCARTPseudoPrior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.tempering_pseudo_prior.</span></span><span class="sig-name descname"><span class="pre">BCARTPseudoPrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_dirichlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_tree_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stored_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tempering_pseudo_prior.html#BCARTPseudoPrior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tempering_pseudo_prior.BCARTPseudoPrior" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bayescart.parallel_tempering_base.BCARTPT" title="bayescart.parallel_tempering_base.BCARTPT"><code class="xref py py-class docutils literal notranslate"><span class="pre">BCARTPT</span></code></a></p>
<p>Bayesian CART with a pseudo-prior used to bias the search towards smaller trees.</p>
<p>The pseudo-prior is used instrumentally in computing the acceptance probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pprior_alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Pseudo-prior alpha parameter (default 0.95).</p></li>
<li><p><strong>pprior_beta</strong> (<em>float</em><em>, </em><em>optional</em>) – Pseudo-prior beta parameter (default 1).</p></li>
</ul>
</dd>
</dl>
<p>Initialize the BCART object with model and MCMC parameters.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tempering_pseudo_prior.BCARTPseudoPrior.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_dirichlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thinning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_tree_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stored_trees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25,</span> <span class="pre">0.25]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#bayescart.tempering_pseudo_prior.BCARTPseudoPrior.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize the BCART object with model and MCMC parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tempering_pseudo_prior.BCARTPseudoPrior.calc_log_p_split">
<span class="sig-name descname"><span class="pre">calc_log_p_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tempering_pseudo_prior.html#BCARTPseudoPrior.calc_log_p_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tempering_pseudo_prior.BCARTPseudoPrior.calc_log_p_split" title="Link to this definition"></a></dt>
<dd><p>Compute the log prior probability of the tree structure (ignoring the specific split values).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>)</p></li>
<li><p><strong>alpha</strong> (<em>float</em>)</p></li>
<li><p><strong>beta</strong> (<em>float</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed log prior probability of the tree structure.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tempering_pseudo_prior.BCARTPseudoPrior.get_acceptance_prob">
<span class="sig-name descname"><span class="pre">get_acceptance_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tempering_pseudo_prior.html#BCARTPseudoPrior.get_acceptance_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tempering_pseudo_prior.BCARTPseudoPrior.get_acceptance_prob" title="Link to this definition"></a></dt>
<dd><p>Compute the acceptance probability for a move using the pseudo-prior adjustment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>)</p></li>
<li><p><strong>move</strong> (<em>str</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The acceptance probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tempering_pseudo_prior.BCARTPseudoPrior.get_swap_acceptance_prob">
<span class="sig-name descname"><span class="pre">get_swap_acceptance_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree_from</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_to</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tempering_pseudo_prior.html#BCARTPseudoPrior.get_swap_acceptance_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tempering_pseudo_prior.BCARTPseudoPrior.get_swap_acceptance_prob" title="Link to this definition"></a></dt>
<dd><p>Compute the swap acceptance probability for the pseudo-prior variant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree_from</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>)</p></li>
<li><p><strong>tree_to</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The swap acceptance probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tempering_pseudo_prior.BCARTPseudoPrior.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tempering_pseudo_prior.html#BCARTPseudoPrior.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tempering_pseudo_prior.BCARTPseudoPrior.run" title="Link to this definition"></a></dt>
<dd><p>Run the Parallel Tempering MCMC sampler.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary containing MCMC results and tempering statistics.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tempering_pseudo_prior.BCARTPseudoPrior.trans_prob_log_pseudoprior">
<span class="sig-name descname"><span class="pre">trans_prob_log_pseudoprior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">move</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_tree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tempering_pseudo_prior.html#BCARTPseudoPrior.trans_prob_log_pseudoprior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tempering_pseudo_prior.BCARTPseudoPrior.trans_prob_log_pseudoprior" title="Link to this definition"></a></dt>
<dd><p>Compute the log transition probability for a move using the pseudo-prior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>move</strong> (<em>str</em>)</p></li>
<li><p><strong>new_tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>)</p></li>
<li><p><strong>old_tree</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The log transition probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-bayescart.tree">
<span id="bayescart-tree-module"></span><h2>bayescart.tree module<a class="headerlink" href="#module-bayescart.tree" title="Link to this heading"></a></h2>
<p>Tree class for bayescart.</p>
<p>This module defines the Tree class that extends treelib’s Tree to support operations
needed for Bayesian CART such as applying splits, copying subtrees, and computing
prior probabilities.</p>
<dl class="py class">
<dt class="sig sig-object py" id="bayescart.tree.Tree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.tree.</span></span><span class="sig-name descname"><span class="pre">Tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_node_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></p>
<p>Extended tree class for Bayesian CART that builds on the treelib Tree.</p>
<p>This class maintains a counter for node IDs and provides additional methods for
sampling leaves, copying trees, and applying splits.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.tree.Tree.id_counter">
<span class="sig-name descname"><span class="pre">id_counter</span></span><a class="headerlink" href="#bayescart.tree.Tree.id_counter" title="Link to this definition"></a></dt>
<dd><p>Counter for unique node identifiers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.tree.Tree.rng">
<span class="sig-name descname"><span class="pre">rng</span></span><a class="headerlink" href="#bayescart.tree.Tree.rng" title="Link to this definition"></a></dt>
<dd><p>Random generator used for sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.random.Generator</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.tree.Tree.node_min_size">
<span class="sig-name descname"><span class="pre">node_min_size</span></span><a class="headerlink" href="#bayescart.tree.Tree.node_min_size" title="Link to this definition"></a></dt>
<dd><p>Minimum number of observations per node.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.tree.Tree.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><a class="headerlink" href="#bayescart.tree.Tree.debug" title="Link to this definition"></a></dt>
<dd><p>If True, enables additional assertions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.tree.Tree.llik">
<span class="sig-name descname"><span class="pre">llik</span></span><a class="headerlink" href="#bayescart.tree.Tree.llik" title="Link to this definition"></a></dt>
<dd><p>Cached integrated log-likelihood of the tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.tree.Tree.log_tree_prior_prob">
<span class="sig-name descname"><span class="pre">log_tree_prior_prob</span></span><a class="headerlink" href="#bayescart.tree.Tree.log_tree_prior_prob" title="Link to this definition"></a></dt>
<dd><p>Cached log prior probability of the tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.tree.Tree.temperature">
<span class="sig-name descname"><span class="pre">temperature</span></span><a class="headerlink" href="#bayescart.tree.Tree.temperature" title="Link to this definition"></a></dt>
<dd><p>The current temperature for tempering.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<p>Initiate a new tree or copy another tree with a shallow or
deep copy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_node_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.__init__" title="Link to this definition"></a></dt>
<dd><p>Initiate a new tree or copy another tree with a shallow or
deep copy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.add_node">
<span class="sig-name descname"><span class="pre">add_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.add_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.add_node" title="Link to this definition"></a></dt>
<dd><p>Add a new node object to the tree and make the parent as the root by default.</p>
<p>The ‘node’ parameter refers to an instance of Class::Node.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.apply_split">
<span class="sig-name descname"><span class="pre">apply_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_leaf_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_leaf_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.apply_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.apply_split" title="Link to this definition"></a></dt>
<dd><p>Apply a split to a leaf node by generating two children nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> (<a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><em>Node</em></a>) – The leaf node to be split.</p></li>
<li><p><strong>split_var</strong> (<em>str</em>) – The feature to split on.</p></li>
<li><p><strong>split_val</strong> (<em>Sequence</em><em>[</em><em>T</em><em>] or </em><em>T</em>) – The split value(s).</p></li>
<li><p><strong>l_leaf_params</strong> (<em>Any</em>) – Parameters for the left child.</p></li>
<li><p><strong>r_leaf_params</strong> (<em>Any</em>) – Parameters for the right child.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.exceptions.InvalidTreeError" title="bayescart.exceptions.InvalidTreeError"><strong>InvalidTreeError</strong></a> – If any of the resulting children have fewer observations than the minimum.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.check_split_struct">
<span class="sig-name descname"><span class="pre">check_split_struct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.check_split_struct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.check_split_struct" title="Link to this definition"></a></dt>
<dd><p>Check that the splitting rules along the subtree starting at a given node
do not produce empty splits.</p>
<p>While this function does not guarantee that the split is valid, its fast
to execute and can filter some obvious incompatibilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>node</strong> (<a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><em>Node</em></a>) – The root of the subtree to check.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.exceptions.InvalidTreeError" title="bayescart.exceptions.InvalidTreeError"><strong>InvalidTreeError</strong></a> – If an empty split is encountered.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.copy" title="Link to this definition"></a></dt>
<dd><p>Deep copy the tree with all node info. If light, don’t deep-copy (X,y) at each node.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.get_children">
<span class="sig-name descname"><span class="pre">get_children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.get_children"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.get_children" title="Link to this definition"></a></dt>
<dd><p>Get the children of the specified node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>node</strong> (<a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><em>Node</em></a><em> or </em><em>int</em>) – The node or its identifier.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of child nodes (ordered as left then right).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the node does not have exactly two children (in non-leaf cases).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.get_leaves">
<span class="sig-name descname"><span class="pre">get_leaves</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.get_leaves"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.get_leaves" title="Link to this definition"></a></dt>
<dd><p>Return all the leaf nodes of the tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of leaf nodes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.get_n_leaves">
<span class="sig-name descname"><span class="pre">get_n_leaves</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.get_n_leaves"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.get_n_leaves" title="Link to this definition"></a></dt>
<dd><p>Get the number of leaf nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The count of leaves.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.get_node">
<span class="sig-name descname"><span class="pre">get_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.get_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.get_node" title="Link to this definition"></a></dt>
<dd><p>Get the object of the node with ID of <code class="docutils literal notranslate"><span class="pre">nid</span></code>.</p>
<p>An alternative way is using ‘[]’ operation on the tree. But small difference exists between them:
<code class="docutils literal notranslate"><span class="pre">get_node()</span></code> will return None if <code class="docutils literal notranslate"><span class="pre">nid</span></code> is absent, whereas ‘[]’ will raise <code class="docutils literal notranslate"><span class="pre">KeyError</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.get_nonleaf_nodes">
<span class="sig-name descname"><span class="pre">get_nonleaf_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.get_nonleaf_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.get_nonleaf_nodes" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.get_parent">
<span class="sig-name descname"><span class="pre">get_parent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.get_parent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.get_parent" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.get_parents_with_two_leaves">
<span class="sig-name descname"><span class="pre">get_parents_with_two_leaves</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.get_parents_with_two_leaves"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.get_parents_with_two_leaves" title="Link to this definition"></a></dt>
<dd><p>Get all internal nodes that have exactly two leaves as children.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of nodes satisfying the condition.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.get_root">
<span class="sig-name descname"><span class="pre">get_root</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.get_root"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.get_root" title="Link to this definition"></a></dt>
<dd><p>Return the root node of the tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The root node.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node">Node</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.get_sibling">
<span class="sig-name descname"><span class="pre">get_sibling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.get_sibling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.get_sibling" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.is_equal">
<span class="sig-name descname"><span class="pre">is_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categories</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.is_equal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.is_equal" title="Link to this definition"></a></dt>
<dd><p>Check if two trees are equal in structure and (optionally) in parameters.</p>
<p>The hard parameter controls how strict the testing should be. Hard = 0 checks
they have the same structure and same splitting variables. Hard = 1 additionally
checks the splitting values. Hard = 2 expects same structure, same splits,
same data in nodes. Hard = 3 expects equality also for leaf parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><em>Tree</em></a>) – The tree to compare with.</p></li>
<li><p><strong>hard</strong> (<em>int</em><em>, </em><em>optional</em>) – Level of strictness (0: structure and split variable; 1: includes split values; 2: includes data; 3: also leaf parameters) (default 0).</p></li>
<li><p><strong>categories</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>set</em><em>] or </em><em>None</em><em>, </em><em>optional</em>) – Mapping of categorical variable values, if needed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the trees are equal under the chosen criteria.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.is_stump">
<span class="sig-name descname"><span class="pre">is_stump</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.is_stump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.is_stump" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.is_valid">
<span class="sig-name descname"><span class="pre">is_valid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.is_valid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.is_valid" title="Link to this definition"></a></dt>
<dd><p>Check whether the tree is valid.</p>
<p>The function recursively checks each node for logical consistency of splits,
data assignments, and node properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the tree passes all validity checks.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.tree.Tree.node_class">
<span class="sig-name descname"><span class="pre">node_class</span></span><a class="headerlink" href="#bayescart.tree.Tree.node_class" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.remove_node">
<span class="sig-name descname"><span class="pre">remove_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.remove_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.remove_node" title="Link to this definition"></a></dt>
<dd><p>Remove a node indicated by ‘identifier’ with all its successors.
Return the number of removed nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.sample_leaf">
<span class="sig-name descname"><span class="pre">sample_leaf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.sample_leaf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.sample_leaf" title="Link to this definition"></a></dt>
<dd><p>Sample a leaf node at random from the tree that has at least node_min_size observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>node_min_size</strong> (<em>int</em>) – Minimum required observations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A randomly chosen leaf node.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node">Node</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#bayescart.exceptions.InvalidTreeError" title="bayescart.exceptions.InvalidTreeError"><strong>InvalidTreeError</strong></a> – If no leaf with sufficient observations is found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.show" title="Link to this definition"></a></dt>
<dd><p>Print the tree. Update all the tags first. Tags are not automatically updated for performance speed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The string representation of the tree.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.update_split">
<span class="sig-name descname"><span class="pre">update_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.update_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.update_split" title="Link to this definition"></a></dt>
<dd><p>Change the splitting rule for the current node. Update the data subset of the children, and of all the descendants recursively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> (<a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><em>Node</em></a>) – The node to update.</p></li>
<li><p><strong>split_var</strong> (<em>str</em>) – The new splitting variable.</p></li>
<li><p><strong>split_val</strong> (<em>Sequence</em><em>[</em><em>T</em><em>] or </em><em>T</em>) – The new splitting value(s).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.Tree.update_subtree_data">
<span class="sig-name descname"><span class="pre">update_subtree_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#Tree.update_subtree_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.Tree.update_subtree_data" title="Link to this definition"></a></dt>
<dd><p>Update the data splits for all descendants of a given node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>node</strong> (<a class="reference internal" href="#bayescart.node.Node" title="bayescart.node.Node"><em>Node</em></a>) – The node whose subtree data will be updated.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bayescart.tree.TreeFast">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bayescart.tree.</span></span><span class="sig-name descname"><span class="pre">TreeFast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_node_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_min_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#TreeFast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.TreeFast" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a></p>
<p>Fast implementation of Tree using NodeFast as the underlying node class. Tree copy is also improved.</p>
<p>Initiate a new tree or copy another tree with a shallow or
deep copy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.TreeFast.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">light</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#TreeFast.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.TreeFast.copy" title="Link to this definition"></a></dt>
<dd><p>Optimized copy of the tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#bayescart.tree.Tree" title="bayescart.tree.Tree"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tree</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bayescart.tree.TreeFast.node_class">
<span class="sig-name descname"><span class="pre">node_class</span></span><a class="headerlink" href="#bayescart.tree.TreeFast.node_class" title="Link to this definition"></a></dt>
<dd><p>alias of <a class="reference internal" href="#bayescart.node.NodeFast" title="bayescart.node.NodeFast"><code class="xref py py-class docutils literal notranslate"><span class="pre">NodeFast</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bayescart.tree.TreeFast.update_subtree_data">
<span class="sig-name descname"><span class="pre">update_subtree_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/tree.html#TreeFast.update_subtree_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.tree.TreeFast.update_subtree_data" title="Link to this definition"></a></dt>
<dd><p>Update the subtree data with a fast preliminary check before performing the full update.</p>
<p>The preliminary check does not count how many observations fall in each node; just whether the splits make logical sense. This is fast. If so, proceed with the proper, expensive check.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-bayescart.utils">
<span id="bayescart-utils-module"></span><h2>bayescart.utils module<a class="headerlink" href="#module-bayescart.utils" title="Link to this heading"></a></h2>
<p>Utility functions for bayescart.</p>
<p>This module provides helper functions for sampling from distributions,
computing log-probability densities, and a generic choice function.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bayescart.utils.dirichlet_logpdf">
<span class="sig-prename descclassname"><span class="pre">bayescart.utils.</span></span><span class="sig-name descname"><span class="pre">dirichlet_logpdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/utils.html#dirichlet_logpdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.utils.dirichlet_logpdf" title="Link to this definition"></a></dt>
<dd><p>Compute the log probability density function of a Dirichlet distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – The point (vector) at which to evaluate the log-pdf.</p></li>
<li><p><strong>alpha</strong> (<em>array-like</em>) – The concentration parameters of the Dirichlet distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The log probability density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bayescart.utils.invgamma_logpdf">
<span class="sig-prename descclassname"><span class="pre">bayescart.utils.</span></span><span class="sig-name descname"><span class="pre">invgamma_logpdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/utils.html#invgamma_logpdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.utils.invgamma_logpdf" title="Link to this definition"></a></dt>
<dd><p>Compute the log probability density function of an inverse gamma distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – The point at which to evaluate the log-pdf.</p></li>
<li><p><strong>a</strong> (<em>float</em>) – The shape parameter.</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – The scale parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The log probability density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bayescart.utils.invgamma_rvs">
<span class="sig-prename descclassname"><span class="pre">bayescart.utils.</span></span><span class="sig-name descname"><span class="pre">invgamma_rvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/utils.html#invgamma_rvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.utils.invgamma_rvs" title="Link to this definition"></a></dt>
<dd><p>Sample a random variate from an inverse gamma distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>float</em>) – The shape parameter (adjusted by 1/2 in this context).</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – The scale parameter.</p></li>
<li><p><strong>rng</strong> (<em>np.random.Generator</em>) – The random number generator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A random variate from the inverse gamma distribution, scaled accordingly.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bayescart.utils.my_choice">
<span class="sig-prename descclassname"><span class="pre">bayescart.utils.</span></span><span class="sig-name descname"><span class="pre">my_choice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/utils.html#my_choice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.utils.my_choice" title="Link to this definition"></a></dt>
<dd><p>Sample a random element from a generic sequence using the provided random generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> (<em>np.random.Generator</em>) – The random number generator.</p></li>
<li><p><strong>a</strong> (<em>Sequence</em><em>[</em><em>elem</em><em>]</em>) – The sequence to sample from.</p></li>
<li><p><strong>replace</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the sampling is done with replacement (default is False).</p></li>
<li><p><strong>p</strong> (<em>Sequence</em><em>[</em><em>float</em><em>] or </em><em>None</em><em>, </em><em>optional</em>) – The probability weights associated with each element (default is None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A randomly selected element from the sequence.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>elem</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bayescart.utils.norm_logpdf">
<span class="sig-prename descclassname"><span class="pre">bayescart.utils.</span></span><span class="sig-name descname"><span class="pre">norm_logpdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/utils.html#norm_logpdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.utils.norm_logpdf" title="Link to this definition"></a></dt>
<dd><p>Compute the log probability density function of a normal distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – The point at which to evaluate the log-pdf.</p></li>
<li><p><strong>a</strong> (<em>float</em>) – The mean of the distribution.</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – The standard deviation of the distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The log probability density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bayescart.utils.plot_chain_comm">
<span class="sig-prename descclassname"><span class="pre">bayescart.utils.</span></span><span class="sig-name descname"><span class="pre">plot_chain_comm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/utils.html#plot_chain_comm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.utils.plot_chain_comm" title="Link to this definition"></a></dt>
<dd><p>Plot the distribution of terminal regions across the chains from a PT run.</p>
<p>This function uses the stored parallel tempering (PT) statistics (the number
of terminal nodes per chain) from the run results and plots them as histograms.
It also prints the final swap acceptance probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res</strong> (<em>dict</em>) – A run result dictionary containing ‘PT_swap_stats’ with key ‘PT_term_reg’
and ‘PT_swap_final_prob’.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – The title of the plot (default is ‘’).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bayescart.utils.plot_hists">
<span class="sig-prename descclassname"><span class="pre">bayescart.utils.</span></span><span class="sig-name descname"><span class="pre">plot_hists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/utils.html#plot_hists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.utils.plot_hists" title="Link to this definition"></a></dt>
<dd><p>Plot the distribution of terminal nodes for the cold chain across runs.</p>
<p>The function extracts the stored terminal node counts from each run in ‘res’
and plots histograms for a selected fraction of the post-burnin iterations,
where idx_range is given as (min_percentage, max_percentage).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res</strong> (<em>list</em><em> or </em><em>sequence</em><em> of </em><em>dict</em>) – A list of run result dictionaries, each containing a ‘setup’ key and a
‘tree_term_reg’ key.</p></li>
<li><p><strong>idx_range</strong> (<em>tuple</em><em>, </em><em>optional</em>) – A tuple (min_percentage, max_percentage) specifying the range (as fractions)
of the available post-burnin observations to use for plotting. Default is (0,1).</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – The title of the plot (default is ‘’).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bayescart.utils.plot_swap_prob">
<span class="sig-prename descclassname"><span class="pre">bayescart.utils.</span></span><span class="sig-name descname"><span class="pre">plot_swap_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/utils.html#plot_swap_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.utils.plot_swap_prob" title="Link to this definition"></a></dt>
<dd><p>Plot the evolution of swap acceptance probabilities over time for PT chains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res</strong> (<em>dict</em>) – A run result dictionary containing ‘PT_swap_stats’ with key
‘PT_swap_prob_over_time’, which is a mapping from iteration numbers to swap
acceptance probabilities.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – The title of the plot (default is ‘’).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bayescart.utils.sim_cgm98">
<span class="sig-prename descclassname"><span class="pre">bayescart.utils.</span></span><span class="sig-name descname"><span class="pre">sim_cgm98</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bayescart/utils.html#sim_cgm98"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bayescart.utils.sim_cgm98" title="Link to this definition"></a></dt>
<dd><p>Simulate data following the CGM98 example.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Number of observations.</p></li>
<li><p><strong>rng</strong> (<em>np.random.Generator</em>) – Random generator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(X, y) where X is a DataFrame with features ‘v1’ and ‘v2’, and y is a Series.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bayescart">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-bayescart" title="Link to this heading"></a></h2>
<p>bayescart: A Python package for Bayesian CART with tempering.</p>
<p>This package provides classes and functions to build, sample, and evaluate
Bayesian CART models with advanced tempering strategies. The package is composed
of modules for node data handling, tree structures, Bayesian CART sampling, and
utility functions.</p>
<dl class="simple">
<dt>Available objects:</dt><dd><ul class="simple">
<li><p>BCARTClassic, BCARTPT, BCARTGeom, BCARTGeomLik, BCARTPseudoPrior</p></li>
<li><p>Tree</p></li>
<li><p>Node</p></li>
<li><p>NodeData, NodeDataRegression, NodeDataClassification</p></li>
<li><p>Utility functions and plotting functions</p></li>
<li><p>Evaluation and functions for analysis</p></li>
<li><p>Exceptions: InvalidTreeError, AbstractMethodError</p></li>
</ul>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="bayescart" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Guglielmo Gattiglio.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>